import re
from allegro_server import myrepo

to_insert = ["84870488688","59149090326","85013676474","27144516737","70349319962","37049012088","84931839420","54949088257","0027789248","84883137370","82755188542","77958185409","54349087327","84908663934","84884754825","49549106899","54949142167","84866020499","77952873336","84930163183","0031997072","7044227557","84880982940","84885170038","63149151180","33845310352","84940437001","77950627875","79960696794","60949087259","56649097301","84865580953","84958758537","84870261279","26844534996","80054685896","54949099618","67650089640","84948956586","84959052967","33644919145","85017329256","77955624116","34748827337","67649989635","68049112358","84862133396","84886717885","84898727225","77956816832","84902179615","84896799759","84862834128","77949567732","80052948456","84861548250","8744290267","84911089043","84930171677","84862025717","55949116643","33846353589","84907948669","0141919410","58549109041","67650107051","54949137673","84927963573","84924703708","33344473820","84892633833","56349155626","69649093300","40949159703","84879135033","42349110014","17544379602","84980410220","84893480629","0037112839","72149109016","70350164036","7044264347","0030206015","84906947686","84956996940","84902134596","77954787395","84958541485","77953258588","84870272278","84919800923","77049086519","0036040746","77957918856","0034543998","85010617640","84876890487","85016245717","25844456084","84941274492","78649313117","33746373977","84903555043","80053120170","84988600792","84873026417","0043265228","84920878397","77951288399","84997218179","69449089688","84878622025","34547189589","77955053249","72249095416","84879654955","70350426581","55849132710","84873279029","84928951184","84874751982","77952400658","80051825169","84864660055","84881074829","84933500454","84890248789","33947727474","71549124368","84856195498","28444474762","84871526704","79959564196","33947200277","84951852066","54949111710","84888255323","84906656267","56849108036","70349897854","68049103050","40949122312","55849148732","84941634424","84899458965","0034545899","48249145190","84973442830","84919436161","84896073405","84873726007","53949122060","84982063381","63449088859","78650724789","84866655607","83755205392","43349089741","84868268216","33847611115","69949090424","82755165158","0037177447","77953738815","78649768820","80052705925","79953182363","84929648821","77955641893","84898829307","84890318073","79956354314","70350157962","84865222248","84870713426","26944503239","0033293705","84901594569","80052058239","84883145498","65749095407","78651512140","84945924661","24144455335","84952886206","84882236754","54949149861","84869032838","84880048120","0032674396","77951936275","84928795773","0037863859","84880360346","84956863375","84932101339","70350181756","84950259543","18844475344","84917705529","84944453035","84943253873","84951934729","70349872049","0029275333","84255208910","84958857304","83155192491","82955203175","84886890818","84872690247","60649120732","84881079636","34250620520","77952362654","37349097012","85009473658","34548104714","77954293510","78549289478","67650671897","84907853458","71549123219","84862229893","79958796011","84911939828","84894569111","84863908555","84873724415","84878981915","0042764003","84924918480","84922341996","22444433857","84897875362","84973616586","34547257087","79954845006","84893181032","77952416017","84869065509","13144257773","33646071890","82055166885","57649118570","78649332884","55849089959","35148880214","84884883069","0347013987","71549153448","0036166540","0030380581","33748434500","84865164923","84901228542","33748756517","84945960675","84866721793","84888299748","84886704824","84943605383","38149107678","84964370207","84884247875","0142135034","77956016298","84892645821","38149108966","78650348155","84884738440","84870345490","73549117889","0034547121","78651557315","84896783377","84865594764","84883681619","33846415050","78649527963","84925239277","84882419143","71549160043","84860153253","67649362274","34848866912","79955824822","84873673190","84901639738","35048838056","0040436095","84953243789","77955393166","69649097266","73549108498","84876487675","84908339519","78650614341","70849084282","0028514837","77950233211","84959328772","58349088570","84880417894","77958048511","0029856660","84924236454","77953323889","84880340924","0032273960","84948666826","84855769231","84988688667","78651245873","84951986304","77957885283","84902465675","84953379941","67649422449","0038783648","72749091069","37449003034","33646179836","57749088456","78751545859","77956606985","78649247009","78751627718","79959702754","84982893794","77951294528","47749084732","84919649093","77955660322","18944388663","84904649707","34250361538","84870906324","56449131494","78149247319","84866162949","84931564094","33747438903","79953750315","77649234077","31744447675","84867165173","79957589036","84905989795","79959266024","79960389401","84902120500","84877308460","78449278700","84871886639","9144221604","77952926831","42449086922","84903945903","84865095905","84866991400","84887164633","84992744063","79959503363","49749113193","80155184821","69649096657","84911002939","85013393660","79951775236","75249086212","69549112870","71749105063","79953199079","77956569348","0036172313","84877784416","84922336320","81855226135","3543125976","77954653810","84891783970","72649106173","69749100628","67650889350","84943402106","84904157746","84876010902","82055180541","56549105566","84897654576","38849156361","82755187061","79957467831","77955638301","84947807357","79960694970","84865440518","84944205632","79952440750","13444283823","84949129224","34447520031","77957779912","84903977560","84949146761","77954194017","77952838783","84878621428","84922279244","84907160405","84893414846","84876236977","84882334938","84907558465","67650230363","84861423366","29544448723","84937923175","84925501470","84877715746","83655172870","84898703930","84901687789","84930038990","84908072687","84962220408","78149247070","84901989630","84986222766","84907046643","79955371316","77949262974","84930960360","84926620560","84876784904","70349283846","77957907630","70349376607","82055187108","84865156626","84941993570","67649625174","84925868348","84918534786","34548659292","84894573518","84886702420","84946571860","77953775146","67449118622","84941660202","84859472332","67949100449","56549128666","84859467529","84856499757","84871707842","77955690717","77956577896","84948661118","70350138225","84958767179","84963732790","75249101318","77958175395","84898703358","82155171286","33749316914","84937700584","84960843493","77957977841","77951831531","84922471929","80051750073","84909595038","84924067769","39049190230","79952640448","84919372478","84969627313","78651340367","84905169575","83155182130","57849162314","82055187112","75249093883","79955515696","84875452103","84893658088","84878740411","77958182798","84948679383","77952638754","84968830253","84860438085","84874384621","84881450009","84867753799","84969540338","67649414930","68349083418","84893741680","84897696509","84870680262","84893374444","21344458591","84889247949","77149160889","67449107211","84929406420","84897437526","38049187486","77957920100","77957812131","84906345397","71749117876","77957078229","33744464531","84905504452","84866982744","84925503987","78649775156","77956608640","84897741028","77953474097","84983036166","83155172802","34250852244","77949426378","52949102185","84892422707","54949115082","84929409246","83755224326","80155208323","41149178497","84901038153","42549147567","43649089769","84875218406","67649322464","77953800517","84964057632","79951595797","84899721670","79954593195","77955683333","84961785345","77951858524","84944463415","38149072473","84923226789","84942516695","84878541234","84876217699","70249090067","58549091525","84862533579","84874399250","33745472212","38549095497","23144437858","84941170655","84964000528","79952235531","79952850177","42149178464","84866647303","83655190874","84879923704","77950147346","84928804430","84884802532","84855959275","84983611293","84958818055","75949084714","56049091082","38449106816","65249113791","84866039122","84904740638","24144449906","53349172509","77957906295","84937598564","85014205932","82155181766","84877263993","84912027091","77958017655","34548066655","84886514156","41149144688","84919771663","84946924692","78049297963","35048882486","20744456954","67651111948","84925872661","79960748513","79958792855","84881068483","84928734034","84942866480","84934942031","84869839321","84907375453","84878696951","84875531580","84937837136","84921534040","84971519341","84892706443","45749108973","77950391968","84937431959","38149114770","79956068971","84928975568","78649369806","84928978282","84948665566","24144468666","14844340623","84893493657","79952668286","33745016712","84862199146","82055182311","35048897437","84951020556","70350583892","84879316572","84868127026","70349888079","21944437418","84948764075","84886911992","84941635632","84875642635","77950804437","84996523357","80053031329","84949122682","84975452637","84892416745","45849138986","84925710775","77149148118","84964005687","25844465951","84987715139","84912060884","83755224906","45749138812","84918537969","78650380351","57149134764","84961572702","85009062108","34547531253","84907365256","84964019045","84873598672","84902293099","78649967339","84891823339","42649132837","84887259862","84898715370","84870327135","84872236700","77955325621","84879198347","78650677527","84895918738","84946118691","84944456418","79952783234","79952453556","79751471317","79959586917","84961864417","78650333803","79957598226","79955798312","84944886188","84945919521","84951919051","80052968141","77952411035","78651593484","84923118513","84865386353","84991687942","70350126003","22944473663","38149059663","84905161336","84930987005","84886939637","29144478289","85013439590","81855187876","84885589918","84897406537","84906772822","84929833198","38949151503","77956866531","78649349668","84889243364","84925497686","47749125768","80052269738","84916936697","77954449053","84877090507","80054000048","85011886813","82055202066","33744459263","69549097496","84957011349","84867394500","77953703323","71849087163","84959329778","82055166896","80054975646","84885710790","84858194505","70049112732","84951032648","77952832499","84885048305","81855212418","84941550557","84860511972","79959537798","84862277857","83755185739","84940381637","85007835882","84921630006","84892838549","84906659284","80054111476","84907472363","84924540571","28244496571","84922337912","84875430138","84957793851","84964833824","84886438777","85014488633","40849124132","33746757615","84905216089","84870810526","0001429926","0003281804","0022062393","0022161776","0022661638","0027540436","0030467822","0031100846","0031482563","0032121858","0033021378","0033993267","0034215726","0034262767","0034847861","0035061022","0035208642","0036380993","0036722975","0037121163","0037196821","0037257047","0037431950","0038046308","0038137458","0041636003","0141842648","0345730920","0346264999","0346361969","1042265736","2342643183","3042687241","3042855533","9544245850"]

repo_conn = myrepo(host='192.168.56.3')
for each_article in to_insert:

    filePath = "abstract_rdf/%s.rdf" % each_article

    intento = open(filePath, 'r').read()

    creators = re.findall('<dc:creator>(.*?)</dc:creator>',
                              intento)[0]

    s = "https://api.elsevier.com/content/abstract/scopus_id/%s" % each_article

    authors = re.findall('<api:Author (.*?)</api:Author>', creators)

    for auth in authors:

        affiliations = re.findall('https://api.elsevier.com/content/affiliation/affiliation_id/[0-9]+', auth)

        authorID = re.search('https://api.elsevier.com/content/author/author_id/[0-9]+', auth).group()
        print(authorID)

        for aff in affiliations:

            print(aff)

            to_insert = "<%s> <%s> <%s> ." % (s, authorID, aff)

            try:
                repo_conn.addData(to_insert)
                print(to_insert)
            except:
                print('triple not complete')